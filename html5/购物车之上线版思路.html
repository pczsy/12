<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修购物车之上线版思路' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>购物车之上线版思路</center></div><div class='banquan'>原文出处:本文由博客园博主des雷锋提供。<br/>
原文连接:https://www.cnblogs.com/wangqingjiu/p/11228023.html</div><br>
    <h2 id="购物车之进阶版">购物车之进阶版</h2>
<pre><code><code> if (this.$store.state.loginState === &#39;ok&#39;) {
        let result = { pic, name, sale, proid, flag, num }
        if (!localStorage.getItem(&#39;cars&#39;)) { //1如果触发时没有本地数据 就将新创建的对象obj和新创建的lis购物车作为新的放进本地
          this.lis.push(result)
          this.obj[this.userinfo] = this.lis
          localStorage.setItem(&#39;cars&#39;, JSON.stringify(this.obj))
        } else { // 2否则就是有本地  如果有本地 下一步
          let dic = JSON.parse(localStorage.getItem(&#39;cars&#39;))
          if (dic[this.userinfo] !== undefined) { // 2.1如果本地obj[此时的用户] ！==undefined 说明这个用户里的购物车有数据
            this.lis = dic[this.userinfo] //有数据就将老数据赋值给 购物车lis
            let flag = false
            this.lis.map(item =&gt; { // 循环老数据，看老数据里的名字与 新添加的 result名字是否有重复
              if (item.name === result.name) {  //2.1.1如果有重复就将老数据的num+1
                item.num += 1
                flag = true //2.1.2并且给flag赋值true 让外面的购物车不要添加进去
              }
            })
            if (!flag) { // 2.1.3如果flag等于flase就说明老数据没有此商品，正常添加
              this.lis.push(result)
              flag = false
            }
            dic[this.userinfo] = this.lis // 最后一步 重新赋值给dic对象
            localStorage.setItem(&#39;cars&#39;, JSON.stringify(dic)) //解析
          } else {
            this.lis.push(result) //2.2如果老数据里没有这个账户。就说明他没有购物车数据，此时就要重新给他添加数据了
            dic[this.userinfo] = this.lis
            // dic[this.userinfo] = this.lis
            localStorage.setItem(&#39;cars&#39;, JSON.stringify(dic))
          }
        }
      } else {
        this.$router.push(&#39;/login&#39;)
      }
    },</code></pre>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>